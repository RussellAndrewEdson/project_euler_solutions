;; Code for Project Euler Problem 41.
;;
;; Code author: Russell A. Edson
;; Date last modified: 18/08/2021

;; We are interested in pandigital prime numbers, so we can reuse and
;; expand on various functions that have been coded in previous problems
;; (e.g. Problem 38 and Problem 37) for manipulating pandigital
;; numbers and prime numbers:
(defun digits (number)
  "Return the set of digits in the given NUMBER."
  (mapcar #'digit-char-p (coerce (write-to-string number) 'list)))

(defun combine-digits (digits)
  "Return the number we get by concatenating the given DIGITS together."
  (values (parse-integer (format nil "濑溟玳趔┅┅ㄤ彐躅瞽疳钿殓轸犰铛礅弪瞟⒃蝓殒翳玳鲥握吐乓泔铘衢铙翳溟玳趔翳蝻蹒萎ㄥ聃犰祜镳骘骝镯躔麸泔祆邈糸铉椹箫螋ㄤ殓轸铛礅弪＇缉┅ㄤ彐躅轶痱轫蹇瞟⒃蝓殒翳玳鲥铛礅弪轶痱轫瀣漆祗殒铒舢ㄩ暴铋戾è痱轫屦舂祜镳骘骝镯躔麸ㄦ祜矧篑螋瞟滹ㄩ弪镳盹愆箦翩痱轫屦铋飑┅痱轫屦┅瞽疳钿殓轸犰脖闯穿换骄ㄩ蟓痱轫蹇脖闯换骄换族麽铘麸溴翦蝽轭翳灬蜱弩瞽溟玳疳钿殓轸犰痱轫瀹换俞驽禊狍篚黹铉翳狒眭篝忮忮赭邋犷ㄢ邈狨箦П哀黠蹯换泔躅狍赭溟玳趔┈翳孱秕篝蜥翦琦箬秕熹忮麸汨邈翳换弓溟玳疳钿殓轸犰铛礅弪骘痱轫犰轸骈蝮衄犷翳孱ㄦ衢扉铉换翳矬濠翳腑溟玳疳钿殓轸犰铛礅弪蟋犷箫镱换换燥箴邋翳轭珞躔麇ъ磲脲躞镦翳狩弩镯沆疱蝽豸狒轱换扉怛狎犷箝眇禊疱蝽豸腩秣疳钿殓轸犰铛礅弪螽澡轶轶眭汨换盹蝈彐骈汩孱翳犷祜镳轭秭弪犰瞽溟玳轭翦珏蝮耢厚蹰汶祜徜Ж恒飙疱蝽豸狒轱瞟ㄤ彐躅瞽溟玳舡疳钿殓轸犰痱轫弩瞟⑻镲翳蝻蹒翳苇溟玳疳钿殓轸犰蟋泔祆邈糸铉痱轫弩ㄩ犷┊戾è痱轫弩铋飑ㄣ飙疱蝽豸狒轱詈滹疱蝽疱蝽豸狒轱瞟戾è铛礅弪ㄣ镯忾铄溟玳趔ㄣ飙疱蝽豸狒轱詈疱蝽麸扉篝疱蝽豸狒轱瞟┅ㄩㄩ蟓痱轫蹇铛礅弪箦翩痱轫弩ㄣ镱铛礅弪痱轫弩┅┅痱轫弩┅ㄤ彐鲠痱轫弩铋飑换族ъ汨邈翳弓溟玳疳钿殓轸犰痱轫弩骈蝮艉糸礤箦翩痱轫弩瞽溟玳舡疳钿殓轸犰痱轫弩供┅换骄碰犰踽糸镱麸镫换骄狈钞共箦泔钿镦蝈犰糸礤换骄狈钞返鞍鞍箦泔钿镦麸翎蝓糸礤ū烦返鞍鞍躞弪爱鞍鞍鞍簌篝屙换骄阴糸礤泔铙轶镦爱氨箦泔钿敲糸礤犷狈钞烦箦泔钿铒瞽敲糸礤换骄构拱眯换骄吹艾副番备惮范痱镢弩箫泫沆弩换骄补艾补爆创怡翦泔铙邃换骄换骄紊换吁蝠蜷箝铉禊咯翳弪麇蝈铒弓溟玳疳钿殓轸犰痱轫铛礅弪蟋换箫麇趄翳腑溟玳镱弩铄艉糸礤箦翩痱轫弩瞽溟玳舡疳钿殓轸犰痱轫弩俯┅换骄碰犰踽糸镱麸镫换骄懂氨箦泔钿镦蝈犰糸礤换骄懂氨刀驳箦泔钿镦麸翎蝓糸礤ǘ氨刀驳躞弪爱鞍鞍鞍簌篝屙换骄构沟眯换骄钡栋爆档船倒痱镢弩箫泫沆弩换骄潮蹈冬车怡翦泔铙邃换骄换骄紊换郁殪铒疳钿殓轸犰痱轫弩族汨邈翳翻溟玳镱弩箝黹灬蜢糸礤箦翩痱轫弩瞽溟玳舡疳钿殓轸犰痱轫弩珐┅换骄碰犰踽糸镱麸镫换骄爱脖箦泔钿镦蝈犰糸礤换骄爱脖阜蛋箦泔钿镦麸翎蝓糸礤ò脖阜蛋躞弪爱鞍鞍鞍簌篝屙换骄卑爱炊眯换骄刀惮犯艾鞍痱镢弩箫泫沆弩换骄超饭船幢怡翦泔铙邃换骄换骄ú背洞捣捕背荡脖冻荡脖党洞恫钡炒恫当炒兜凡贝捣恫贝换骄刀卜贝刀脖闯挡侗反捣捕贝返捕贝挡倍捶挡贝冻挡贝范换骄挡繁炊挡贝扯驳倍捶驳侗反捕当闯捕当反捕捣贝卜兜贝换骄范驳贝斗驳贝恫捣贝恫当反恫狈荡范脖荡卜侗荡脖范荡换骄卜倍荡凡倍荡凡钡洞脖刀闯卜贝刀脖吹范凡倍吹卜倍吹换骄卜侗吹恫贝返恫贝捣恫贝车脖炊车脖闯刀泊背兜捕幢车换骄恫幢党卜幢兜泊当扯泊返倍泊当冻泊捣侗凡炊当捕反当换骄凡洞当驳捶侗捣泊倍挡反倍挡捶倍挡幢斗挡炊狈挡炊繁换骄捣泊侗挡斗幢挡洞狈挡洞背刀泊背刀泊繁刀凡幢捣恫幢换骄返恫幢范挡幢兜凡幢兜卜幢兜泊背兜床繁兜捶脖斗荡脖换骄荡恫背荡恫狈荡范脖荡凡侗荡捕繁荡捕狈荡脖斗荡脖范换骄返床倍吹脖扯反挡倍吹凡倍吹脖冻炊挡狈捶兜脖洞挡背换骄洞凡当范床当反恫当炊驳繁床兜背床兜繁床范当捶驳侗换骄床捣侗床捣倍反脖刀床繁刀床倍捣床倍返捶脖兜炊脖党换骄洞脖捣床侗车床背刀床潮刀床冻钡洞渤当洞渤返洞凡车换骄反捕车床车范捶渤刀床党倍反驳扯床党斗床党侗捶驳冻换骄反驳冻床斗党床兜烦炊凡党斗吹渤炊挡潮吹恫潮吹恫烦换骄吹斗渤反刀渤吹捕撤吹渤斗吹卜扯捶挡扯荡渤倍捣床扯换骄荡渤侗荡捕撤荡凡冻捣床冻捣炊渤刀捶渤刀反渤返洞渤换骄兜反渤兜凡闯返恫闯刀泊潮挡范闯返泊冻挡反冻挡闯范换骄挡闯倍卜荡扯驳捶扯驳闯侗驳炊潮驳捶冻捕荡潮捕荡撤换骄恫捣闯恫吹烦恫反党范泊党凡洞党捕反党捕捶党捕吹撤换骄泊刀烦泊刀撤泊捣扯卜吹扯凡吹扯卜闯刀泊扯当泊扯捣换骄泊范车泊斗车凡洞车斗泊车恫闯钡泊潮兜渤幢刀恫炒当换骄捕撤吹捕炒当渤洞当卜扯吹凡炒兜渤吹侗渤捶刀卜炒刀换骄渤荡倍渤返洞卜车洞渤范荡渤兜捶捕撤荡恫车反恫车幢换骄恫返炒范驳炒捕捣炒捕党反驳冻幢驳范炒凡刀炒凡党洞换骄驳炒斗驳撤炊凡党炊挡炒倍捣渤炊挡扯反挡撤洞捣捕炒换骄挡斗炒挡冻幢刀凡炒返恫炒挡潮洞驳扯贝驳冻贝恫车贝换骄渤钡洞捕潮吹巢贝刀巢贝兜巢倍吹冻脖吹巢侗荡巢钡炊换骄巢当炊冻挡贝车捕贝党脖炊党脖洞刀巢反返扯泊党卜炊换骄烦挡炊车泊侗车捕反撤挡洞撤刀泊车恫幢扯返泊撤兜泊换骄冻挡反冻驳捶斗巢荡烦恫荡扯凡荡巢兜反巢捣洞巢刀捶换骄巢刀幢巢荡范撤驳炊烦泊刀巢吹范巢炊返烦泊兜巢洞捣换骄扯卜吹扯凡吹扯泊钡巢炊钡巢幢兜炒脖刀炒脖兜扯床钡换骄冻床钡冻床当扯床捣炒恫当炒恫返炒斗驳炒卜刀撤床刀换骄炒返捕炒捣捕炒挡斗炒刀脖炒刀凡撤炊挡炒斗挡炒兜卜换骄扯反挡斗炒挡冻捶挡冻吹凡冻吹卜冻荡脖车范床撤刀床换骄烦刀床车反恫车炊凡车炊卜车床范烦荡捕车床倍党床倍换骄党床范党捶恫捣炒恫返扯床党范床党斗床刀炒脖刀炒凡换骄捣冻床刀捶巢刀闯脖荡冻脖荡冻凡返炊巢荡扯凡荡扯卜换骄荡扯脖荡烦捕吹撤捕反刀巢吹冻卜吹冻脖炊捣巢洞返巢换骄洞党凡洞车凡洞撤挡闯兜卜反车恫闯返恫闯刀凡闯刀脖换骄捶巢刀闯驳侗闯捕捣闯凡兜反巢兜闯恫返炊撤驳洞烦驳换骄闯脖兜闯辈兜闯侗驳炊潮挡洞车辈吹冻辈荡潮恫荡扯辈换骄兜闯辈党洞辈党炊辈党幢恫冻吹辈炒刀辈炒当恫炒钡恫换骄炒侗驳炒辈兜炒辈刀潮吹恫潮荡捕潮刀床潮兜床车倍床换骄车贝捕刀潮床党侗泊党辈炊车辈洞车侗泊潮挡炊潮捕荡换骄扯辈荡冻辈荡扯辈吹潮捕吹潮泊兜潮泊刀背泊刀背恫吹换骄倍巢吹背刀泊钡巢洞兜背床当扯床钡冻床倍党床背刀床换骄背荡捕背吹恫侗炒驳倍炒驳背床兜背床刀贝扯驳贝冻驳换骄贝扯挡贝车恫贝党捕倍吹巢侗吹巢钡炊巢当闯捕刀贝巢换骄兜贝巢刀幢巢吹背恫吹倍巢吹侗巢幢兜巢幢车恫范幢驳换骄幢范驳捶倍驳反辈兜幢凡兜幢卜兜幢捕党幢驳冻幢驳斗换骄捶辈刀反辈刀幢返捕幢挡范幢捣恫反钡恫幢斗挡洞钡渤换骄洞当凡洞捣辈炊返辈炊捣辈吹侗渤吹侗凡反当恫吹繁捕换骄反当捕返幢恫捣炊辈荡侗凡荡侗卜兜幢凡返侗床捣侗床换骄当洞卜当洞凡返贝恫当炊渤当床冻钡炊卜钡反恫钡洞渤换骄繁兜床侗返床侗荡凡侗荡卜侗吹卜侗吹凡斗贝挡倍反挡换骄倍捶挡贝兜卜贝范挡繁吹恫贝挡冻贝驳扯繁床刀狈床刀换骄贝卜刀贝捕返贝卜兜贝范驳倍捶驳狈洞驳繁洞驳侗反驳换骄侗床捣侗泊返倍凡吹倍泊捣辈洞党辈洞捣狈捕吹繁捕吹换骄繁泊兜辈炊捣辈炊党辈吹范辈捶刀辈荡扯繁驳炊狈驳炊换骄辈捣炊辈荡冻辈返洞繁捕荡辈范荡侗挡反侗返泊钡范泊换骄繁挡洞狈挡洞钡凡洞钡泊冻钡泊范当凡炊当捕闯当范泊换骄当恫反当恫捶斗当泊兜辈闯兜辈炒当捕炒当渤炊钡恫炒换骄倍挡炒倍驳炒辈兜炒辈刀炒辈冻荡辈炒兜珐换物麇栳鲥骈钺祆骘躅箫礤ㄡ祜簟镦翳疳钿殓轸犰痱轫换铛礅弪螽族箝眇禊翎脲翳灬蜱弩镦翳弩瀹ㄡ痧禊＇磲痱轫弩换骄范挡幢